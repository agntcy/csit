# Llama-deploy example: Sum two numbers using distributed workflows

## Description
This example is based on the examples provided in [llama-deploy](https://github.com/run-llama/llama_deploy/tree/main/examples).
The application is intentionally simplistic, with its primary goal being to demonstrate how two Llama workflows
can communicate and exchange information.

The app generates two numbers and computes their sum. It consists of four main components:
* **Control Plane**: Orchestrates the deployment and manages the overall workflow.
* **Message Queue**: Enables message exchange between components, utilizing the basic queue provided by llama-deploy.
* **Number Generator Workflow**: Randomly generates a number within a specified range (1 to a maximum value).
* **Sum Workflow**: Calculates the sum of the numbers generated by the Number Generator Workflow.

## Run the application

### Run the application using different processess
To execute the application, you can run each component as a separate process. To do so, follow these steps:
1. Run all application components
```
task stack:up
```
2. Run the application
```
task run:app
```
3. To kill all processes
```
task stack:down
```

### Run the application using a Kind cluster
First you need to install Kind with a local registry. You can use the script available here: https://kind.sigs.k8s.io/docs/user/local-registry/#create-a-cluster-and-registry
Once the kind cluster is set you can follow these steps
1. Deploy the app (this may take some time)
```
task kind:deploy
```
Run `kubectl get pod` to confirm that all pods are running.
```
$ kubectl get pod -n llama-deploy-demo
NAME                             READY   STATUS    RESTARTS   AGE
control-plane-658866cf48-wxfpb   1/1     Running   0          42m
gen-784f766ff5-wmhqn             1/1     Running   0          42m
message-queue-7d589994f7-2z9hc   1/1     Running   0          42m
sum-554498c7cc-xhz4d             1/1     Running   0          42m
```
2. Once the all pods are running set the port forwarding
```
task kind:port-forward
```
3. Now you can run the app
```
task run:app
```
4. Delete the app from the cluster
```
task kind:delete
```

## Communication between components
A full representation of the communication between the components of this app can be found in the
[confluence page](https://cisco-eti.atlassian.net/wiki/spaces/PHI/pages/970129458/Llama-Deploy+message+and+communication)
dedicated to llama-deploy.
